---
layout: post
title:  Maiores Remunerações da Câmara
published: true
tags: [htmlwidgets, r]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(screenshot.force = FALSE, echo = FALSE, fig.cap = "")
library(dplyr)
library(devtools)
library(DT)
library(flexdashboard)
library(highcharter)
library(knitr)
library(ggplot2)
library(rCharts)
library(readr)
library(reshape2)
require(scales)
library(shiny)
library(plotly)
```


```{r pre_processing, include=FALSE}
#knitr::opts_chunk$set(screenshot.force = FALSE, echo = FALSE)

data_filename = "../../_data/camara_dados.txt"
data <- read.csv2(file=data_filename, sep=",", header=FALSE, stringsAsFactors=FALSE, na.strings="unknown", dec=".", encoding = "UTF-8")
colnames(data) <-  c("mes","ano","cargo","vinculo","nome","remuneracao_fixa","vantagens_pessoais","remuneracao_eventual","abono_permanencia","descontos","diarias","outros_auxilios","outras_vantagens")

data <- mutate(data, remuneracao_total=remuneracao_fixa+vantagens_pessoais+remuneracao_eventual+abono_permanencia-descontos+diarias+outros_auxilios+outras_vantagens)

ano_max <- max(data$ano)
ano_min <- min(data$ano)

#cor_do_site = "#2c3e50" #azul
#cor_do_site = "#99fdd9" #verde
cor_do_site = "primary"

options(scipen=999, OutDec= ",")

topSalarios <- function(salariosAgregados, column_ref, keeps, size) {
  topSalarios <- salariosAgregados[order(column_ref, decreasing=TRUE)[1:size],]
  rownames(topSalarios) <- NULL
  colnames(topSalarios) <- keeps
  return(topSalarios)
}

keeps <- c("Nome","Cargo","Vnculo","Mês","Ano","Remuneração Total (R$)")
salariosAgregados <- aggregate(remuneracao_total~nome+cargo+vinculo+mes+ano, FUN=sum, data)
top_servidores_todos <- topSalarios(salariosAgregados, salariosAgregados$remuneracao_total, keeps, 10)

todos_servidores_recente <- data[data$ano==ano_max,]

gasto_de_referencia <- sum(top_servidores_todos$`Remuneração Total (R$)`)

todos_deputados <- filter(data, grepl("DEPUTADO", cargo))
todos_deputados_recente <- todos_deputados[todos_deputados$ano==ano_max,]

remuneracao_total <- sum(data$remuneracao_total)
remuneracao_recente <- sum(todos_servidores_recente$remuneracao_total)
remuneracao_deputados <- sum(todos_deputados$remuneracao_total)
remuneracao_deputados_recente <- sum(todos_deputados_recente$remuneracao_total)

keeps <- c("Nome","Mês","Ano","Remuneração Total (R$)")
salariosAgregados <- aggregate(remuneracao_total~nome+mes+ano, FUN=sum, todos_deputados)
top_deputados_todos <- topSalarios(salariosAgregados, salariosAgregados$remuneracao_total, keeps, 10)

salariosAgregados <- aggregate(remuneracao_total~nome+mes+ano, FUN=sum, todos_deputados_recente)
top_deputados_recente <- topSalarios(salariosAgregados, salariosAgregados$remuneracao_total, keeps, 10)

teto_constitucional <- 37476.93

```

Considerando todos os servidores da Câmara, no período de `r ano_min` a `r ano_max`, o site da transparência disponibiliza o pagamento para `r round(nrow(data)/10^3, 0)` mil servidores, o equivalente à R$ `r round(sum(data$remuneracao_total)/(10^9), 1)` BILHÕES. Só deputados são `r round(nrow(todos_deputados)/10^3, 0)` mil na folha de pagamento, correspondendo à `r round(nrow(todos_deputados)/nrow(data)*100, 1)`% do total nesse intervalo de tempo. Mas, ao observarmos o momentante pago aos deputados, percebe-se que eles corresponde à R$ `r round(remuneracao_deputados/(10^6), 0)` MILHÕES em pagamentos, ou seja, `r round(remuneracao_deputados/remuneracao_total*100, 1)`% do total. Só em `r ano_max`, `r round(nrow(todos_servidores_recente)/10^3, 1)` mil servidores já foram pagos pela Câmara, sendo `r round(nrow(todos_deputados_recente)/10^3, 1)` mil desputados, ou `r round(nrow(todos_deputados_recente)/nrow(todos_servidores_recente)*100, 1)`% do total. Em outras palavras, foi pago R$ `r round(remuneracao_deputados_recente/10^6, 1)` MILHÕES em remuneração dos servidores, sendo R$ `r round(remuneracao_deputados_recente/10^6, 1)` MILHÕES destinados aos deputados (`r round(remuneracao_deputados_recente/remuneracao_recente*100, 1)`% do total).


* **Maiores remunerações da Câmara**
  
  Os dez servidores que receberam as mais elevadas remunerações, no período de `r ano_min` e `r ano_max`, são apresentados na tabela seguinte. Totalizando R$ `r round(gasto_de_referencia/10^3, 0)` mil, entende-se por remuneração total a soma da remuneração fixa, mais vantagens pessoais, mais remuneração eventual, mais abono permanência, menos descontos, mais diárias, mais outros auxílios e vantagens. Na tabela, é apresentado o nome completo do servidor, o seu respectivo cargo, o seu vínculo, o mês e o ano de referência do pagamento, assim como a remuneração total.

```{r top_servidores_todos, echo=FALSE}
datatable(top_servidores_todos, options = list(paging=F,info=F,searching=F), rownames=FALSE)
```








## Deputados mais Remunerados
```{r, echo=FALSE}
remuneracao_top_deputados <- sum(top_deputados_todos$`Remuneração Total (R$)`)
remuneracao_top_deputados_recentes <- sum(top_deputados_recente$`Remuneração Total (R$)`)
```

* **Quais deputados mais remunerados em um só mês?**
  
  Entre os anos de `r ano_min` e `r ano_max`, `r round(nrow(todos_deputados)/10^3, 1)` mil deputados foram pagos. Na tabela seguinte, nós destacamos quais dez deputados mais remunerados nesse período, que receberam `r round(remuneracao_top_deputados/10^3, 1)` mil. A remuneração Total corresponde a soma da remuneração fixa, mais vantagens pessoais, mais remuneração eventual, mais abono permanência, menos descontos, mais diárias, mais outros auxílios e vantagens.

```{r top_deputados_todos, echo=FALSE}
datatable(top_deputados_todos, options = list(paging=F,info=F,searching=F), rownames=FALSE)
```

* **Quais deputados mais remunerados em um só mês de 2017?**
  
  Seguindo o mesmo cálculo da remuneração total, apresentamos quais dez deputados mais receberam em `r ano_max`, correspondendo à R$ `r round(remuneracao_top_deputados_recentes/10^3, 1)` mil no total. Nesse mesmo ano, `r round(nrow(todos_deputados_recente)/10^3, 1)` mil deputados foram pagos, sendo um total R$ `r round(remuneracao_deputados_recente/10^6, 1)` MILHÕES

```{r top_deputados_recente, echo=FALSE}
datatable(top_deputados_recente, options = list(paging=F,info=F,searching=F), rownames=FALSE)
```

